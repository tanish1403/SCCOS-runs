{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "013f1236",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:24:13.474029Z",
     "iopub.status.busy": "2025-03-18T09:24:13.473727Z",
     "iopub.status.idle": "2025-03-18T09:24:17.589625Z",
     "shell.execute_reply": "2025-03-18T09:24:17.588761Z"
    },
    "papermill": {
     "duration": 4.121713,
     "end_time": "2025-03-18T09:24:17.591123",
     "exception": false,
     "start_time": "2025-03-18T09:24:13.469410",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "nvcc: NVIDIA (R) Cuda compiler driver\r\n",
      "Copyright (c) 2005-2023 NVIDIA Corporation\r\n",
      "Built on Tue_Aug_15_22:02:13_PDT_2023\r\n",
      "Cuda compilation tools, release 12.2, V12.2.140\r\n",
      "Build cuda_12.2.r12.2/compiler.33191640_0\r\n",
      "PyTorch: 2.5.1+cu121 CUDA Available: True CUDA Version: 12.1\r\n"
     ]
    }
   ],
   "source": [
    "!nvcc --version\n",
    "!python -c \"import torch; print('PyTorch:', torch.__version__, 'CUDA Available:', torch.cuda.is_available(), 'CUDA Version:', torch.version.cuda)\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "f5d77a73",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:24:17.598498Z",
     "iopub.status.busy": "2025-03-18T09:24:17.598253Z",
     "iopub.status.idle": "2025-03-18T09:25:11.220458Z",
     "shell.execute_reply": "2025-03-18T09:25:11.219379Z"
    },
    "papermill": {
     "duration": 53.627552,
     "end_time": "2025-03-18T09:25:11.222111",
     "exception": false,
     "start_time": "2025-03-18T09:24:17.594559",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[33mWARNING: Skipping mmcv as it is not installed.\u001b[0m\u001b[33m\r\n",
      "\u001b[0m\u001b[33mWARNING: Skipping mmcv-full as it is not installed.\u001b[0m\u001b[33m\r\n",
      "\u001b[0m\u001b[33mWARNING: Skipping mmdet as it is not installed.\u001b[0m\u001b[33m\r\n",
      "\u001b[0m"
     ]
    }
   ],
   "source": [
    "# Step 2: Uninstall Conflicting Packages\n",
    "!pip uninstall -y mmcv mmcv-full mmdet torch torchvision tensorflow tensorboard -q"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "ad0d96c0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:25:11.229885Z",
     "iopub.status.busy": "2025-03-18T09:25:11.229651Z",
     "iopub.status.idle": "2025-03-18T09:27:25.334843Z",
     "shell.execute_reply": "2025-03-18T09:27:25.333751Z"
    },
    "papermill": {
     "duration": 134.110776,
     "end_time": "2025-03-18T09:27:25.336524",
     "exception": false,
     "start_time": "2025-03-18T09:25:11.225748",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.0/2.0 GB\u001b[0m \u001b[31m525.8 kB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m24.2/24.2 MB\u001b[0m \u001b[31m79.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\r\n",
      "pytorch-lightning 2.5.0.post0 requires torch>=2.1.0, but you have torch 1.13.1+cu116 which is incompatible.\r\n",
      "torchaudio 2.5.1+cu121 requires torch==2.5.1, but you have torch 1.13.1+cu116 which is incompatible.\r\n",
      "torchmetrics 1.6.1 requires torch>=2.0.0, but you have torch 1.13.1+cu116 which is incompatible.\u001b[0m\u001b[31m\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m46.0/46.0 MB\u001b[0m \u001b[31m17.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m46.8/46.8 kB\u001b[0m \u001b[31m1.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m256.2/256.2 kB\u001b[0m \u001b[31m7.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.5/1.5 MB\u001b[0m \u001b[31m19.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m259.5/259.5 kB\u001b[0m \u001b[31m5.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m57.0/57.0 kB\u001b[0m \u001b[31m3.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m50.1/50.1 kB\u001b[0m \u001b[31m3.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m89.7/89.7 kB\u001b[0m \u001b[31m5.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m449.6/449.6 kB\u001b[0m \u001b[31m15.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m52.7/52.7 kB\u001b[0m \u001b[31m3.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m311.5/311.5 kB\u001b[0m \u001b[31m18.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m62.8/62.8 kB\u001b[0m \u001b[31m3.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m239.4/239.4 kB\u001b[0m \u001b[31m15.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m506.5/506.5 kB\u001b[0m \u001b[31m24.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m77.1/77.1 kB\u001b[0m \u001b[31m5.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m144.2/144.2 kB\u001b[0m \u001b[31m9.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m953.1/953.1 kB\u001b[0m \u001b[31m42.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m99.5/99.5 kB\u001b[0m \u001b[31m6.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h  Building wheel for oss2 (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "  Building wheel for aliyun-python-sdk-core (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "  Building wheel for crcmod (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\r\n",
      "dopamine-rl 4.1.0 requires tensorflow>=2.2.0, which is not installed.\r\n",
      "tensorflow-decision-forests 1.10.0 requires tensorflow==2.17.0, which is not installed.\r\n",
      "datasets 3.3.1 requires requests>=2.32.2, but you have requests 2.28.2 which is incompatible.\r\n",
      "datasets 3.3.1 requires tqdm>=4.66.3, but you have tqdm 4.65.2 which is incompatible.\r\n",
      "featuretools 1.31.0 requires tqdm>=4.66.3, but you have tqdm 4.65.2 which is incompatible.\r\n",
      "gcsfs 2024.10.0 requires fsspec==2024.10.0, but you have fsspec 2024.12.0 which is incompatible.\r\n",
      "google-cloud-bigtable 2.27.0 requires google-api-core[grpc]<3.0.0dev,>=2.16.0, but you have google-api-core 1.34.1 which is incompatible.\r\n",
      "google-colab 1.0.0 requires notebook==6.5.5, but you have notebook 6.5.4 which is incompatible.\r\n",
      "google-colab 1.0.0 requires pandas==2.2.2, but you have pandas 2.2.3 which is incompatible.\r\n",
      "google-colab 1.0.0 requires requests==2.32.3, but you have requests 2.28.2 which is incompatible.\r\n",
      "jupyterlab-server 2.27.3 requires requests>=2.31, but you have requests 2.28.2 which is incompatible.\r\n",
      "langchain 0.3.12 requires async-timeout<5.0.0,>=4.0.0; python_version < \"3.11\", but you have async-timeout 5.0.1 which is incompatible.\r\n",
      "pandas-gbq 0.25.0 requires google-api-core<3.0.0dev,>=2.10.2, but you have google-api-core 1.34.1 which is incompatible.\r\n",
      "plotnine 0.14.4 requires matplotlib>=3.8.0, but you have matplotlib 3.7.5 which is incompatible.\r\n",
      "pymc 5.19.1 requires rich>=13.7.1, but you have rich 13.4.2 which is incompatible.\r\n",
      "pytensor 2.26.4 requires filelock>=3.15, but you have filelock 3.14.0 which is incompatible.\r\n",
      "pytorch-lightning 2.5.0.post0 requires torch>=2.1.0, but you have torch 1.13.1+cu116 which is incompatible.\r\n",
      "sphinx 8.1.3 requires requests>=2.30.0, but you have requests 2.28.2 which is incompatible.\r\n",
      "torchmetrics 1.6.1 requires torch>=2.0.0, but you have torch 1.13.1+cu116 which is incompatible.\r\n",
      "yfinance 0.2.50 requires requests>=2.31, but you have requests 2.28.2 which is incompatible.\u001b[0m\u001b[31m\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m452.7/452.7 kB\u001b[0m \u001b[31m7.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h"
     ]
    }
   ],
   "source": [
    "!pip install torch==1.13.1+cu116 torchvision==0.14.1+cu116 -f https://download.pytorch.org/whl/torch_stable.html -q\n",
    "!pip install mmcv-full==1.7.1 -f https://download.openmmlab.com/mmcv/dist/cu116/torch1.13.0/index.html -q\n",
    "!pip install mmdet==2.28.2 -q\n",
    "!pip install -U openmim -q\n",
    "!mim install \"mmengine>=0.7.0\" -q\n",
    "!pip install xmltodict -q  # For dataset conversion"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "2b5fd4ad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:27:25.410087Z",
     "iopub.status.busy": "2025-03-18T09:27:25.409793Z",
     "iopub.status.idle": "2025-03-18T09:27:26.926657Z",
     "shell.execute_reply": "2025-03-18T09:27:26.925670Z"
    },
    "papermill": {
     "duration": 1.555206,
     "end_time": "2025-03-18T09:27:26.928331",
     "exception": false,
     "start_time": "2025-03-18T09:27:25.373125",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "nvcc: NVIDIA (R) Cuda compiler driver\r\n",
      "Copyright (c) 2005-2023 NVIDIA Corporation\r\n",
      "Built on Tue_Aug_15_22:02:13_PDT_2023\r\n",
      "Cuda compilation tools, release 12.2, V12.2.140\r\n",
      "Build cuda_12.2.r12.2/compiler.33191640_0\r\n",
      "PyTorch: 1.13.1+cu116 CUDA Available: True CUDA Version: 11.6\r\n"
     ]
    }
   ],
   "source": [
    "!nvcc --version\n",
    "!python -c \"import torch; print('PyTorch:', torch.__version__, 'CUDA Available:', torch.cuda.is_available(), 'CUDA Version:', torch.version.cuda)\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ce0e5cef",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:27:27.002565Z",
     "iopub.status.busy": "2025-03-18T09:27:27.002267Z",
     "iopub.status.idle": "2025-03-18T09:27:40.903117Z",
     "shell.execute_reply": "2025-03-18T09:27:40.902247Z"
    },
    "papermill": {
     "duration": 13.939847,
     "end_time": "2025-03-18T09:27:40.904805",
     "exception": false,
     "start_time": "2025-03-18T09:27:26.964958",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cloning into '/kaggle/working/mmrotate'...\r\n",
      "remote: Enumerating objects: 3897, done.\u001b[K\r\n",
      "remote: Counting objects: 100% (1261/1261), done.\u001b[K\r\n",
      "remote: Compressing objects: 100% (384/384), done.\u001b[K\r\n",
      "remote: Total 3897 (delta 983), reused 877 (delta 877), pack-reused 2636 (from 2)\u001b[K\r\n",
      "Receiving objects: 100% (3897/3897), 25.33 MiB | 14.73 MiB/s, done.\r\n",
      "Resolving deltas: 100% (2382/2382), done.\r\n",
      "/kaggle/working/mmrotate\n",
      "Obtaining file:///kaggle/working/mmrotate\r\n",
      "  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "Collecting e2cnn (from mmrotate==0.3.4)\r\n",
      "  Downloading e2cnn-0.2.3-py3-none-any.whl.metadata (15 kB)\r\n",
      "Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (from mmrotate==0.3.4) (3.7.5)\r\n",
      "Requirement already satisfied: mmcv-full in /usr/local/lib/python3.10/dist-packages (from mmrotate==0.3.4) (1.7.1)\r\n",
      "Requirement already satisfied: mmdet<3.0.0,>=2.25.1 in /usr/local/lib/python3.10/dist-packages (from mmrotate==0.3.4) (2.28.2)\r\n",
      "Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from mmrotate==0.3.4) (1.26.4)\r\n",
      "Requirement already satisfied: pycocotools in /usr/local/lib/python3.10/dist-packages (from mmrotate==0.3.4) (2.0.8)\r\n",
      "Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from mmrotate==0.3.4) (1.17.0)\r\n",
      "Requirement already satisfied: terminaltables in /usr/local/lib/python3.10/dist-packages (from mmrotate==0.3.4) (3.1.10)\r\n",
      "Requirement already satisfied: torch in /usr/local/lib/python3.10/dist-packages (from mmrotate==0.3.4) (1.13.1+cu116)\r\n",
      "Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from mmdet<3.0.0,>=2.25.1->mmrotate==0.3.4) (1.13.1)\r\n",
      "Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from e2cnn->mmrotate==0.3.4) (1.13.1)\r\n",
      "Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib->mmrotate==0.3.4) (1.3.1)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib->mmrotate==0.3.4) (0.12.1)\r\n",
      "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib->mmrotate==0.3.4) (4.55.3)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib->mmrotate==0.3.4) (1.4.7)\r\n",
      "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib->mmrotate==0.3.4) (24.2)\r\n",
      "Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib->mmrotate==0.3.4) (11.0.0)\r\n",
      "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib->mmrotate==0.3.4) (3.2.0)\r\n",
      "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib->mmrotate==0.3.4) (2.9.0.post0)\r\n",
      "Requirement already satisfied: mkl_fft in /usr/local/lib/python3.10/dist-packages (from numpy->mmrotate==0.3.4) (1.3.8)\r\n",
      "Requirement already satisfied: mkl_random in /usr/local/lib/python3.10/dist-packages (from numpy->mmrotate==0.3.4) (1.2.4)\r\n",
      "Requirement already satisfied: mkl_umath in /usr/local/lib/python3.10/dist-packages (from numpy->mmrotate==0.3.4) (0.1.1)\r\n",
      "Requirement already satisfied: mkl in /usr/local/lib/python3.10/dist-packages (from numpy->mmrotate==0.3.4) (2025.0.1)\r\n",
      "Requirement already satisfied: tbb4py in /usr/local/lib/python3.10/dist-packages (from numpy->mmrotate==0.3.4) (2022.0.0)\r\n",
      "Requirement already satisfied: mkl-service in /usr/local/lib/python3.10/dist-packages (from numpy->mmrotate==0.3.4) (2.4.1)\r\n",
      "Requirement already satisfied: addict in /usr/local/lib/python3.10/dist-packages (from mmcv-full->mmrotate==0.3.4) (2.4.0)\r\n",
      "Requirement already satisfied: pyyaml in /usr/local/lib/python3.10/dist-packages (from mmcv-full->mmrotate==0.3.4) (6.0.2)\r\n",
      "Requirement already satisfied: yapf in /usr/local/lib/python3.10/dist-packages (from mmcv-full->mmrotate==0.3.4) (0.43.0)\r\n",
      "Requirement already satisfied: opencv-python>=3 in /usr/local/lib/python3.10/dist-packages (from mmcv-full->mmrotate==0.3.4) (4.10.0.84)\r\n",
      "Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from torch->mmrotate==0.3.4) (4.12.2)\r\n",
      "Requirement already satisfied: intel-openmp>=2024 in /usr/local/lib/python3.10/dist-packages (from mkl->numpy->mmrotate==0.3.4) (2024.2.0)\r\n",
      "Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.10/dist-packages (from mkl->numpy->mmrotate==0.3.4) (2022.0.0)\r\n",
      "Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.10/dist-packages (from tbb==2022.*->mkl->numpy->mmrotate==0.3.4) (1.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.10/dist-packages (from mkl_umath->numpy->mmrotate==0.3.4) (2024.2.0)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy->e2cnn->mmrotate==0.3.4) (1.3.0)\r\n",
      "Requirement already satisfied: platformdirs>=3.5.1 in /usr/local/lib/python3.10/dist-packages (from yapf->mmcv-full->mmrotate==0.3.4) (4.3.6)\r\n",
      "Requirement already satisfied: tomli>=2.0.1 in /usr/local/lib/python3.10/dist-packages (from yapf->mmcv-full->mmrotate==0.3.4) (2.2.1)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.10/dist-packages (from intel-openmp>=2024->mkl->numpy->mmrotate==0.3.4) (2024.2.0)\r\n",
      "Downloading e2cnn-0.2.3-py3-none-any.whl (225 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m225.3/225.3 kB\u001b[0m \u001b[31m4.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hInstalling collected packages: e2cnn, mmrotate\r\n",
      "  Running setup.py develop for mmrotate\r\n",
      "Successfully installed e2cnn-0.2.3 mmrotate-0.3.4\r\n"
     ]
    }
   ],
   "source": [
    "# Step 4: Clone and Install MMRotate 0.3.4\n",
    "!git clone https://github.com/open-mmlab/mmrotate.git /kaggle/working/mmrotate\n",
    "%cd /kaggle/working/mmrotate\n",
    "# !git checkout v0.3.4  # Ensure exact version\n",
    "!pip install -r requirements/build.txt -q\n",
    "!pip install -v -e . -q"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "7e8dc9f7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:27:40.981658Z",
     "iopub.status.busy": "2025-03-18T09:27:40.981373Z",
     "iopub.status.idle": "2025-03-18T09:27:42.298343Z",
     "shell.execute_reply": "2025-03-18T09:27:42.297496Z"
    },
    "papermill": {
     "duration": 1.356599,
     "end_time": "2025-03-18T09:27:42.299867",
     "exception": false,
     "start_time": "2025-03-18T09:27:40.943268",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "mmcv-full                          1.7.1\r\n",
      "mmdet                              2.28.2\r\n",
      "mmengine                           0.10.7\r\n",
      "mmrotate                           0.3.4                /kaggle/working/mmrotate\r\n",
      "pytorch-ignite                     0.5.1\r\n",
      "pytorch-lightning                  2.5.0.post0\r\n",
      "torch                              1.13.1+cu116\r\n",
      "torchaudio                         2.5.1+cu121\r\n",
      "torchinfo                          1.8.0\r\n",
      "torchmetrics                       1.6.1\r\n",
      "torchsummary                       1.5.1\r\n",
      "torchtune                          0.5.0\r\n",
      "torchvision                        0.14.1+cu116\r\n"
     ]
    }
   ],
   "source": [
    "# Step 5: Verify Installations\n",
    "!pip list | grep -E 'torch|mmcv|mmdet|mmengine|mmrotate'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "f25da6d3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:27:42.376991Z",
     "iopub.status.busy": "2025-03-18T09:27:42.376690Z",
     "iopub.status.idle": "2025-03-18T09:27:42.391365Z",
     "shell.execute_reply": "2025-03-18T09:27:42.390744Z"
    },
    "papermill": {
     "duration": 0.054365,
     "end_time": "2025-03-18T09:27:42.392680",
     "exception": false,
     "start_time": "2025-03-18T09:27:42.338315",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Step 6: Prepare Dataset (SCCOS to DOTA format)\n",
    "import os\n",
    "import shutil\n",
    "import random\n",
    "import xmltodict\n",
    "import tqdm\n",
    "import math\n",
    "\n",
    "dataset_path = \"/kaggle/input/sccos-dataset/\"\n",
    "working_dir = \"/kaggle/working/sccos_dota\"\n",
    "train_images_dir = os.path.join(working_dir, \"train/images\")\n",
    "train_labels_dir = os.path.join(working_dir, \"train/labels\")\n",
    "val_images_dir = os.path.join(working_dir, \"val/images\")\n",
    "val_labels_dir = os.path.join(working_dir, \"val/labels\")\n",
    "test_images_dir = os.path.join(working_dir, \"test/images\")\n",
    "test_labels_dir = os.path.join(working_dir, \"test/labels\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "c3a00a22",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:27:42.468469Z",
     "iopub.status.busy": "2025-03-18T09:27:42.468152Z",
     "iopub.status.idle": "2025-03-18T09:29:51.263387Z",
     "shell.execute_reply": "2025-03-18T09:29:51.262291Z"
    },
    "papermill": {
     "duration": 128.834791,
     "end_time": "2025-03-18T09:29:51.264881",
     "exception": false,
     "start_time": "2025-03-18T09:27:42.430090",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Dataset split: Train=3711, Val=464, Test=464\n",
      "Converting train set to DOTA format...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 3711/3711 [00:01<00:00, 2200.48it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Converting val set to DOTA format...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 464/464 [00:00<00:00, 2176.14it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Converting test set to DOTA format...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 464/464 [00:00<00:00, 2375.16it/s]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Dataset conversion to DOTA format complete.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "# Clean and recreate directories\n",
    "if os.path.exists(working_dir):\n",
    "    shutil.rmtree(working_dir)\n",
    "for dir_path in [train_images_dir, train_labels_dir, val_images_dir, val_labels_dir, test_images_dir, test_labels_dir]:\n",
    "    os.makedirs(dir_path, exist_ok=True)\n",
    "\n",
    "# Source paths\n",
    "train_img_dir = os.path.join(dataset_path, \"train/images\")\n",
    "train_ann_dir = os.path.join(dataset_path, \"train/annotations\")\n",
    "test_img_dir = os.path.join(dataset_path, \"test/images\")\n",
    "test_ann_dir = os.path.join(dataset_path, \"test/annotations\")\n",
    "\n",
    "# Get all files and split\n",
    "train_files = [f for f in os.listdir(train_img_dir) if f.endswith('.png')]\n",
    "test_files = [f for f in os.listdir(test_img_dir) if f.endswith('.png')]\n",
    "random.seed(42)\n",
    "random.shuffle(train_files)\n",
    "random.shuffle(test_files)\n",
    "test_size = len(test_files)\n",
    "val_size = test_size // 2\n",
    "val_files = test_files[:val_size]\n",
    "test_files = test_files[val_size:]\n",
    "\n",
    "# Copy files\n",
    "def copy_files(file_list, src_img_dir, src_ann_dir, dst_img_dir, dst_ann_dir):\n",
    "    for img_file in file_list:\n",
    "        shutil.copy(os.path.join(src_img_dir, img_file), os.path.join(dst_img_dir, img_file))\n",
    "        ann_file = img_file.replace('.png', '.xml')\n",
    "        if os.path.exists(os.path.join(src_ann_dir, ann_file)):\n",
    "            shutil.copy(os.path.join(src_ann_dir, ann_file), os.path.join(dst_ann_dir, ann_file))\n",
    "\n",
    "copy_files(train_files, train_img_dir, train_ann_dir, train_images_dir, train_labels_dir)\n",
    "copy_files(val_files, test_img_dir, test_ann_dir, val_images_dir, val_labels_dir)\n",
    "copy_files(test_files, test_img_dir, test_ann_dir, test_images_dir, test_labels_dir)\n",
    "print(f\"Dataset split: Train={len(train_files)}, Val={len(val_files)}, Test={len(test_files)}\")\n",
    "\n",
    "# Convert XML to DOTA format\n",
    "def convert_robndbox_to_corners(cx, cy, w, h, angle):\n",
    "    angle = float(angle)\n",
    "    cx, cy, w, h = float(cx), float(cy), float(w), float(h)\n",
    "    cos_a = math.cos(angle)\n",
    "    sin_a = math.sin(angle)\n",
    "    dx, dy = w / 2, h / 2\n",
    "    corners = [(-dx, -dy), (dx, -dy), (dx, dy), (-dx, dy)]\n",
    "    rotated_corners = [(cx + x * cos_a - y * sin_a, cy + x * sin_a + y * cos_a) for x, y in corners]\n",
    "    return rotated_corners\n",
    "\n",
    "def convert_xml_to_dota(xml_path, output_label_dir):\n",
    "    with open(xml_path, 'r') as f:\n",
    "        xml_data = xmltodict.parse(f.read())\n",
    "    objects = xml_data['annotation'].get('object', [])\n",
    "    if not isinstance(objects, list):\n",
    "        objects = [objects] if objects else []\n",
    "    txt_lines = []\n",
    "    for obj in objects:\n",
    "        if obj and 'robndbox' in obj:\n",
    "            robndbox = obj['robndbox']\n",
    "            try:\n",
    "                cx, cy, w, h, angle = robndbox['cx'], robndbox['cy'], robndbox['w'], robndbox['h'], robndbox['angle']\n",
    "                (x1, y1), (x2, y2), (x3, y3), (x4, y4) = convert_robndbox_to_corners(cx, cy, w, h, angle)\n",
    "                class_name = \"ship\"\n",
    "                difficulty = 0\n",
    "                txt_lines.append(f\"{x1:.2f} {y1:.2f} {x2:.2f} {y2:.2f} {x3:.2f} {y3:.2f} {x4:.2f} {y4:.2f} {class_name} {difficulty}\")\n",
    "            except (KeyError, ValueError) as e:\n",
    "                print(f\"Invalid robndbox data in {xml_path}: {e}\")\n",
    "                continue\n",
    "    txt_filename = os.path.splitext(os.path.basename(xml_path))[0] + \".txt\"\n",
    "    txt_path = os.path.join(output_label_dir, txt_filename)\n",
    "    if txt_lines:\n",
    "        with open(txt_path, 'w') as f:\n",
    "            f.write(\"\\n\".join(txt_lines))\n",
    "    os.remove(xml_path)\n",
    "\n",
    "for split, label_dir in [(\"train\", train_labels_dir), (\"val\", val_labels_dir), (\"test\", test_labels_dir)]:\n",
    "    print(f\"Converting {split} set to DOTA format...\")\n",
    "    for xml_file in tqdm.tqdm(os.listdir(label_dir)):\n",
    "        if xml_file.endswith(\".xml\"):\n",
    "            convert_xml_to_dota(os.path.join(label_dir, xml_file), label_dir)\n",
    "print(\"Dataset conversion to DOTA format complete.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "173cad73",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:29:51.344784Z",
     "iopub.status.busy": "2025-03-18T09:29:51.344509Z",
     "iopub.status.idle": "2025-03-18T09:31:34.678608Z",
     "shell.execute_reply": "2025-03-18T09:31:34.677569Z"
    },
    "papermill": {
     "duration": 103.375474,
     "end_time": "2025-03-18T09:31:34.680110",
     "exception": false,
     "start_time": "2025-03-18T09:29:51.304636",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m190.2/190.2 kB\u001b[0m \u001b[31m5.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Validating training images...\n",
      "Empty file detected: /kaggle/working/sccos_dota/train/images/2284.png\n",
      "Removed bad image: /kaggle/working/sccos_dota/train/images/2284.png\n",
      "Removed corresponding label: /kaggle/working/sccos_dota/train/labels/2284.txt\n",
      "Found and handled 1 bad files.\n"
     ]
    }
   ],
   "source": [
    "# NEW: Fix YAPF compatibility issue\n",
    "!pip install yapf==0.32.0 -q  # Pin to a version compatible with MMCV 1.7.1\n",
    "\n",
    "# NEW: Validate training images\n",
    "import os\n",
    "import cv2\n",
    "import mmcv\n",
    "\n",
    "def validate_images(image_dir, label_dir):\n",
    "    bad_files = []\n",
    "    for img_file in os.listdir(image_dir):\n",
    "        if not img_file.endswith('.png'):\n",
    "            continue\n",
    "        img_path = os.path.join(image_dir, img_file)\n",
    "        # Check if file is empty\n",
    "        if os.path.getsize(img_path) == 0:\n",
    "            bad_files.append(img_file)\n",
    "            print(f\"Empty file detected: {img_path}\")\n",
    "            continue\n",
    "        # Try loading with mmcv (mimics pipeline behavior)\n",
    "        try:\n",
    "            img = mmcv.imread(img_path)\n",
    "            if img is None:\n",
    "                raise ValueError(\"Image loaded as None\")\n",
    "        except Exception as e:\n",
    "            bad_files.append(img_file)\n",
    "            print(f\"Corrupt or unreadable file: {img_path} - Error: {e}\")\n",
    "    \n",
    "    # Remove bad files and their labels\n",
    "    for bad_file in bad_files:\n",
    "        img_path = os.path.join(image_dir, bad_file)\n",
    "        label_file = bad_file.replace('.png', '.txt')\n",
    "        label_path = os.path.join(label_dir, label_file)\n",
    "        if os.path.exists(img_path):\n",
    "            os.remove(img_path)\n",
    "            print(f\"Removed bad image: {img_path}\")\n",
    "        if os.path.exists(label_path):\n",
    "            os.remove(label_path)\n",
    "            print(f\"Removed corresponding label: {label_path}\")\n",
    "    \n",
    "    if bad_files:\n",
    "        print(f\"Found and handled {len(bad_files)} bad files.\")\n",
    "    else:\n",
    "        print(\"All images validated successfully.\")\n",
    "\n",
    "# Validate training set\n",
    "train_images_dir = \"/kaggle/working/sccos_dota/train/images\"\n",
    "train_labels_dir = \"/kaggle/working/sccos_dota/train/labels\"\n",
    "print(\"Validating training images...\")\n",
    "validate_images(train_images_dir, train_labels_dir)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "fa6d836d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:31:34.759374Z",
     "iopub.status.busy": "2025-03-18T09:31:34.758939Z",
     "iopub.status.idle": "2025-03-18T09:31:34.766034Z",
     "shell.execute_reply": "2025-03-18T09:31:34.765366Z"
    },
    "papermill": {
     "duration": 0.047866,
     "end_time": "2025-03-18T09:31:34.767204",
     "exception": false,
     "start_time": "2025-03-18T09:31:34.719338",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "RoI Transformer configuration saved to /kaggle/working/mmrotate/configs/roi_trans/roi_trans_r50_fpn_1x_sccos.py\n"
     ]
    }
   ],
   "source": [
    "# Step 7: Create Config File for RoI Transformer\n",
    "config_content = \"\"\"\n",
    "_base_ = [\n",
    "    '../_base_/datasets/dotav1.py', '../_base_/schedules/schedule_1x.py',\n",
    "    '../_base_/default_runtime.py'\n",
    "]\n",
    "\n",
    "angle_version = 'le90'  # Use [-90, 90) range for oriented bounding boxes\n",
    "dataset_type = 'DOTADataset'\n",
    "data_root = '/kaggle/working/sccos_dota/'\n",
    "classes = ('ship',)  # Single class\n",
    "img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\n",
    "\n",
    "train_pipeline = [\n",
    "    dict(type='LoadImageFromFile'),\n",
    "    dict(type='LoadAnnotations', with_bbox=True),\n",
    "    dict(type='RResize', img_scale=(1024, 1024)),\n",
    "    dict(\n",
    "        type='RRandomFlip',\n",
    "        flip_ratio=[0.25, 0.25, 0.25],\n",
    "        direction=['horizontal', 'vertical', 'diagonal'],\n",
    "        version=angle_version),\n",
    "    dict(type='Normalize', **img_norm_cfg),\n",
    "    dict(type='Pad', size_divisor=32),\n",
    "    dict(type='DefaultFormatBundle'),\n",
    "    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])\n",
    "]\n",
    "test_pipeline = [\n",
    "    dict(type='LoadImageFromFile'),\n",
    "    dict(type='MultiScaleFlipAug', img_scale=(1024, 1024), flip=False,\n",
    "         transforms=[\n",
    "             dict(type='RResize'),\n",
    "             dict(type='Normalize', **img_norm_cfg),\n",
    "             dict(type='Pad', size_divisor=32),\n",
    "             dict(type='DefaultFormatBundle'),\n",
    "             dict(type='Collect', keys=['img'])\n",
    "         ])\n",
    "]\n",
    "\n",
    "data = dict(\n",
    "    samples_per_gpu=2,\n",
    "    workers_per_gpu=2,\n",
    "    train=dict(\n",
    "        type=dataset_type,\n",
    "        ann_file=data_root + 'train/labels/',\n",
    "        img_prefix=data_root + 'train/images/',\n",
    "        pipeline=train_pipeline,\n",
    "        classes=classes,\n",
    "        version=angle_version),\n",
    "    val=dict(\n",
    "        type=dataset_type,\n",
    "        ann_file=data_root + 'val/labels/',\n",
    "        img_prefix=data_root + 'val/images/',\n",
    "        pipeline=test_pipeline,\n",
    "        classes=classes,\n",
    "        version=angle_version),\n",
    "    test=dict(\n",
    "        type=dataset_type,\n",
    "        ann_file=data_root + 'test/labels/',\n",
    "        img_prefix=data_root + 'test/images/',\n",
    "        pipeline=test_pipeline,\n",
    "        classes=classes,\n",
    "        version=angle_version))\n",
    "\n",
    "evaluation = dict(interval=1, metric='mAP')\n",
    "optimizer = dict(type='SGD', lr=0.005, momentum=0.9, weight_decay=0.0001)\n",
    "optimizer_config = dict(grad_clip=None)\n",
    "lr_config = dict(\n",
    "    policy='step',\n",
    "    warmup='linear',\n",
    "    warmup_iters=500,\n",
    "    warmup_ratio=0.001,\n",
    "    step=[8, 11])\n",
    "runner = dict(type='EpochBasedRunner', max_epochs=1)\n",
    "checkpoint_config = dict(interval=1)\n",
    "log_config = dict(interval=100, hooks=[dict(type='TextLoggerHook')])\n",
    "\n",
    "model = dict(\n",
    "    type='RoITransformer',\n",
    "    backbone=dict(\n",
    "        type='ResNet',\n",
    "        depth=50,\n",
    "        num_stages=4,\n",
    "        out_indices=(0, 1, 2, 3),\n",
    "        frozen_stages=1,\n",
    "        norm_cfg=dict(type='BN', requires_grad=True),\n",
    "        norm_eval=True,\n",
    "        style='pytorch',\n",
    "        init_cfg=dict(type='Pretrained', checkpoint='torchvision://resnet50')),\n",
    "    neck=dict(\n",
    "        type='FPN',\n",
    "        in_channels=[256, 512, 1024, 2048],\n",
    "        out_channels=256,\n",
    "        num_outs=5),\n",
    "    rpn_head=dict(\n",
    "        type='RotatedRPNHead',\n",
    "        in_channels=256,\n",
    "        feat_channels=256,\n",
    "        version=angle_version,\n",
    "        anchor_generator=dict(\n",
    "            type='AnchorGenerator',\n",
    "            scales=[8],\n",
    "            ratios=[0.5, 1.0, 2.0],\n",
    "            strides=[4, 8, 16, 32, 64]),\n",
    "        bbox_coder=dict(\n",
    "            type='DeltaXYWHBBoxCoder',\n",
    "            target_means=[0.0, 0.0, 0.0, 0.0],\n",
    "            target_stds=[1.0, 1.0, 1.0, 1.0]),\n",
    "        loss_cls=dict(type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),\n",
    "        loss_bbox=dict(type='SmoothL1Loss', beta=1.0 / 9.0, loss_weight=1.0)),\n",
    "    roi_head=dict(\n",
    "        type='RoITransRoIHead',\n",
    "        version=angle_version,\n",
    "        num_stages=2,\n",
    "        stage_loss_weights=[1, 1],\n",
    "        bbox_roi_extractor=[\n",
    "            dict(\n",
    "                type='SingleRoIExtractor',\n",
    "                roi_layer=dict(\n",
    "                    type='RoIAlign', output_size=7, sampling_ratio=0),\n",
    "                out_channels=256,\n",
    "                featmap_strides=[4, 8, 16, 32]),\n",
    "            dict(\n",
    "                type='RotatedSingleRoIExtractor',\n",
    "                roi_layer=dict(\n",
    "                    type='RoIAlignRotated',\n",
    "                    out_size=7,\n",
    "                    sample_num=2,\n",
    "                    clockwise=True),\n",
    "                out_channels=256,\n",
    "                featmap_strides=[4, 8, 16, 32]),\n",
    "        ],\n",
    "        bbox_head=[\n",
    "            dict(\n",
    "                type='RotatedShared2FCBBoxHead',\n",
    "                in_channels=256,\n",
    "                fc_out_channels=1024,\n",
    "                roi_feat_size=7,\n",
    "                num_classes=1,  # Single class: ship\n",
    "                bbox_coder=dict(\n",
    "                    type='DeltaXYWHAHBBoxCoder',\n",
    "                    angle_range=angle_version,\n",
    "                    norm_factor=2,\n",
    "                    edge_swap=True,\n",
    "                    target_means=[0.0, 0.0, 0.0, 0.0, 0.0],\n",
    "                    target_stds=[0.1, 0.1, 0.2, 0.2, 1]),\n",
    "                reg_class_agnostic=True,\n",
    "                loss_cls=dict(type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),\n",
    "                loss_bbox=dict(type='SmoothL1Loss', beta=1.0, loss_weight=1.0)),\n",
    "            dict(\n",
    "                type='RotatedShared2FCBBoxHead',\n",
    "                in_channels=256,\n",
    "                fc_out_channels=1024,\n",
    "                roi_feat_size=7,\n",
    "                num_classes=1,  # Single class: ship\n",
    "                bbox_coder=dict(\n",
    "                    type='DeltaXYWHAOBBoxCoder',\n",
    "                    angle_range=angle_version,\n",
    "                    norm_factor=None,\n",
    "                    edge_swap=True,\n",
    "                    proj_xy=True,\n",
    "                    target_means=[0.0, 0.0, 0.0, 0.0, 0.0],\n",
    "                    target_stds=[0.05, 0.05, 0.1, 0.1, 0.5]),\n",
    "                reg_class_agnostic=False,\n",
    "                loss_cls=dict(type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),\n",
    "                loss_bbox=dict(type='SmoothL1Loss', beta=1.0, loss_weight=1.0))\n",
    "        ]),\n",
    "    train_cfg=dict(\n",
    "        rpn=dict(\n",
    "            assigner=dict(\n",
    "                type='MaxIoUAssigner',\n",
    "                pos_iou_thr=0.7,\n",
    "                neg_iou_thr=0.3,\n",
    "                min_pos_iou=0.3,\n",
    "                match_low_quality=True,\n",
    "                ignore_iof_thr=-1),\n",
    "            sampler=dict(\n",
    "                type='RandomSampler',\n",
    "                num=256,\n",
    "                pos_fraction=0.5,\n",
    "                neg_pos_ub=-1,\n",
    "                add_gt_as_proposals=False),\n",
    "            allowed_border=0,\n",
    "            pos_weight=-1,\n",
    "            debug=False),\n",
    "        rpn_proposal=dict(\n",
    "            nms_pre=2000,\n",
    "            max_per_img=2000,\n",
    "            nms=dict(type='nms', iou_threshold=0.7),\n",
    "            min_bbox_size=0),\n",
    "        rcnn=[\n",
    "            dict(\n",
    "                assigner=dict(\n",
    "                    type='MaxIoUAssigner',\n",
    "                    pos_iou_thr=0.5,\n",
    "                    neg_iou_thr=0.5,\n",
    "                    min_pos_iou=0.5,\n",
    "                    match_low_quality=False,\n",
    "                    ignore_iof_thr=-1,\n",
    "                    iou_calculator=dict(type='BboxOverlaps2D')),\n",
    "                sampler=dict(\n",
    "                    type='RandomSampler',\n",
    "                    num=512,\n",
    "                    pos_fraction=0.25,\n",
    "                    neg_pos_ub=-1,\n",
    "                    add_gt_as_proposals=True),\n",
    "                pos_weight=-1,\n",
    "                debug=False),\n",
    "            dict(\n",
    "                assigner=dict(\n",
    "                    type='MaxIoUAssigner',\n",
    "                    pos_iou_thr=0.5,\n",
    "                    neg_iou_thr=0.5,\n",
    "                    min_pos_iou=0.5,\n",
    "                    match_low_quality=False,\n",
    "                    ignore_iof_thr=-1,\n",
    "                    iou_calculator=dict(type='RBboxOverlaps2D')),\n",
    "                sampler=dict(\n",
    "                    type='RRandomSampler',\n",
    "                    num=512,\n",
    "                    pos_fraction=0.25,\n",
    "                    neg_pos_ub=-1,\n",
    "                    add_gt_as_proposals=True),\n",
    "                pos_weight=-1,\n",
    "                debug=False)\n",
    "        ]),\n",
    "    test_cfg=dict(\n",
    "        rpn=dict(\n",
    "            nms_pre=2000,\n",
    "            max_per_img=2000,\n",
    "            nms=dict(type='nms', iou_threshold=0.7),\n",
    "            min_bbox_size=0),\n",
    "        rcnn=dict(\n",
    "            nms_pre=2000,\n",
    "            min_bbox_size=0,\n",
    "            score_thr=0.05,\n",
    "            nms=dict(type=angle_version, iou_thr=0.1),\n",
    "            max_per_img=2000))\n",
    ")\n",
    "\"\"\"\n",
    "\n",
    "config_path = \"/kaggle/working/mmrotate/configs/roi_trans/roi_trans_r50_fpn_1x_sccos.py\"\n",
    "with open(config_path, 'w') as f:\n",
    "    f.write(config_content)\n",
    "print(f\"RoI Transformer configuration saved to {config_path}\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "5e0c9bec",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:31:34.845676Z",
     "iopub.status.busy": "2025-03-18T09:31:34.845453Z",
     "iopub.status.idle": "2025-03-18T09:44:22.230524Z",
     "shell.execute_reply": "2025-03-18T09:44:22.229338Z"
    },
    "papermill": {
     "duration": 767.426288,
     "end_time": "2025-03-18T09:44:22.232383",
     "exception": false,
     "start_time": "2025-03-18T09:31:34.806095",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/working/mmrotate\n",
      "/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/albumentations/__init__.py:24: UserWarning: A new version of Albumentations is available: 2.0.5 (you have 1.4.20). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.\r\n",
      "  check_for_updates()\r\n",
      "/kaggle/working/mmrotate/mmrotate/utils/setup_env.py:38: UserWarning: Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed.\r\n",
      "  warnings.warn(\r\n",
      "/kaggle/working/mmrotate/mmrotate/utils/setup_env.py:48: UserWarning: Setting MKL_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed.\r\n",
      "  warnings.warn(\r\n",
      "2025-03-18 09:31:42,798 - mmrotate - INFO - Environment info:\r\n",
      "------------------------------------------------------------\r\n",
      "sys.platform: linux\r\n",
      "Python: 3.10.12 (main, Nov  6 2024, 20:22:13) [GCC 11.4.0]\r\n",
      "CUDA available: True\r\n",
      "GPU 0: Tesla P100-PCIE-16GB\r\n",
      "CUDA_HOME: /usr/local/cuda\r\n",
      "NVCC: Cuda compilation tools, release 12.2, V12.2.140\r\n",
      "GCC: x86_64-linux-gnu-gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\r\n",
      "PyTorch: 1.13.1+cu116\r\n",
      "PyTorch compiling details: PyTorch built with:\r\n",
      "  - GCC 9.3\r\n",
      "  - C++ Version: 201402\r\n",
      "  - Intel(R) oneAPI Math Kernel Library Version 2025.0.1-Product Build 20241031 for Intel(R) 64 architecture applications\r\n",
      "  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)\r\n",
      "  - OpenMP 201511 (a.k.a. OpenMP 4.5)\r\n",
      "  - LAPACK is enabled (usually provided by MKL)\r\n",
      "  - NNPACK is enabled\r\n",
      "  - CPU capability usage: AVX2\r\n",
      "  - CUDA Runtime 11.6\r\n",
      "  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86\r\n",
      "  - CuDNN 8.3.2  (built against CUDA 11.5)\r\n",
      "  - Magma 2.6.1\r\n",
      "  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.6, CUDNN_VERSION=8.3.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, \r\n",
      "\r\n",
      "TorchVision: 0.14.1+cu116\r\n",
      "OpenCV: 4.10.0\r\n",
      "MMCV: 1.7.1\r\n",
      "MMCV Compiler: GCC 9.3\r\n",
      "MMCV CUDA Compiler: 11.6\r\n",
      "MMRotate: 0.3.4+b030f38\r\n",
      "------------------------------------------------------------\r\n",
      "\r\n",
      "2025-03-18 09:31:43,046 - mmrotate - INFO - Distributed training: False\r\n",
      "2025-03-18 09:31:43,420 - mmrotate - INFO - Config:\r\n",
      "dataset_type = 'DOTADataset'\r\n",
      "data_root = '/kaggle/working/sccos_dota/'\r\n",
      "img_norm_cfg = dict(\r\n",
      "    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\r\n",
      "train_pipeline = [\r\n",
      "    dict(type='LoadImageFromFile'),\r\n",
      "    dict(type='LoadAnnotations', with_bbox=True),\r\n",
      "    dict(type='RResize', img_scale=(1024, 1024)),\r\n",
      "    dict(\r\n",
      "        type='RRandomFlip',\r\n",
      "        flip_ratio=[0.25, 0.25, 0.25],\r\n",
      "        direction=['horizontal', 'vertical', 'diagonal'],\r\n",
      "        version='le90'),\r\n",
      "    dict(\r\n",
      "        type='Normalize',\r\n",
      "        mean=[123.675, 116.28, 103.53],\r\n",
      "        std=[58.395, 57.12, 57.375],\r\n",
      "        to_rgb=True),\r\n",
      "    dict(type='Pad', size_divisor=32),\r\n",
      "    dict(type='DefaultFormatBundle'),\r\n",
      "    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])\r\n",
      "]\r\n",
      "test_pipeline = [\r\n",
      "    dict(type='LoadImageFromFile'),\r\n",
      "    dict(\r\n",
      "        type='MultiScaleFlipAug',\r\n",
      "        img_scale=(1024, 1024),\r\n",
      "        flip=False,\r\n",
      "        transforms=[\r\n",
      "            dict(type='RResize'),\r\n",
      "            dict(\r\n",
      "                type='Normalize',\r\n",
      "                mean=[123.675, 116.28, 103.53],\r\n",
      "                std=[58.395, 57.12, 57.375],\r\n",
      "                to_rgb=True),\r\n",
      "            dict(type='Pad', size_divisor=32),\r\n",
      "            dict(type='DefaultFormatBundle'),\r\n",
      "            dict(type='Collect', keys=['img'])\r\n",
      "        ])\r\n",
      "]\r\n",
      "data = dict(\r\n",
      "    samples_per_gpu=2,\r\n",
      "    workers_per_gpu=2,\r\n",
      "    train=dict(\r\n",
      "        type='DOTADataset',\r\n",
      "        ann_file='/kaggle/working/sccos_dota/train/labels/',\r\n",
      "        img_prefix='/kaggle/working/sccos_dota/train/images/',\r\n",
      "        pipeline=[\r\n",
      "            dict(type='LoadImageFromFile'),\r\n",
      "            dict(type='LoadAnnotations', with_bbox=True),\r\n",
      "            dict(type='RResize', img_scale=(1024, 1024)),\r\n",
      "            dict(\r\n",
      "                type='RRandomFlip',\r\n",
      "                flip_ratio=[0.25, 0.25, 0.25],\r\n",
      "                direction=['horizontal', 'vertical', 'diagonal'],\r\n",
      "                version='le90'),\r\n",
      "            dict(\r\n",
      "                type='Normalize',\r\n",
      "                mean=[123.675, 116.28, 103.53],\r\n",
      "                std=[58.395, 57.12, 57.375],\r\n",
      "                to_rgb=True),\r\n",
      "            dict(type='Pad', size_divisor=32),\r\n",
      "            dict(type='DefaultFormatBundle'),\r\n",
      "            dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])\r\n",
      "        ],\r\n",
      "        classes=('ship', ),\r\n",
      "        version='le90'),\r\n",
      "    val=dict(\r\n",
      "        type='DOTADataset',\r\n",
      "        ann_file='/kaggle/working/sccos_dota/val/labels/',\r\n",
      "        img_prefix='/kaggle/working/sccos_dota/val/images/',\r\n",
      "        pipeline=[\r\n",
      "            dict(type='LoadImageFromFile'),\r\n",
      "            dict(\r\n",
      "                type='MultiScaleFlipAug',\r\n",
      "                img_scale=(1024, 1024),\r\n",
      "                flip=False,\r\n",
      "                transforms=[\r\n",
      "                    dict(type='RResize'),\r\n",
      "                    dict(\r\n",
      "                        type='Normalize',\r\n",
      "                        mean=[123.675, 116.28, 103.53],\r\n",
      "                        std=[58.395, 57.12, 57.375],\r\n",
      "                        to_rgb=True),\r\n",
      "                    dict(type='Pad', size_divisor=32),\r\n",
      "                    dict(type='DefaultFormatBundle'),\r\n",
      "                    dict(type='Collect', keys=['img'])\r\n",
      "                ])\r\n",
      "        ],\r\n",
      "        classes=('ship', ),\r\n",
      "        version='le90'),\r\n",
      "    test=dict(\r\n",
      "        type='DOTADataset',\r\n",
      "        ann_file='/kaggle/working/sccos_dota/test/labels/',\r\n",
      "        img_prefix='/kaggle/working/sccos_dota/test/images/',\r\n",
      "        pipeline=[\r\n",
      "            dict(type='LoadImageFromFile'),\r\n",
      "            dict(\r\n",
      "                type='MultiScaleFlipAug',\r\n",
      "                img_scale=(1024, 1024),\r\n",
      "                flip=False,\r\n",
      "                transforms=[\r\n",
      "                    dict(type='RResize'),\r\n",
      "                    dict(\r\n",
      "                        type='Normalize',\r\n",
      "                        mean=[123.675, 116.28, 103.53],\r\n",
      "                        std=[58.395, 57.12, 57.375],\r\n",
      "                        to_rgb=True),\r\n",
      "                    dict(type='Pad', size_divisor=32),\r\n",
      "                    dict(type='DefaultFormatBundle'),\r\n",
      "                    dict(type='Collect', keys=['img'])\r\n",
      "                ])\r\n",
      "        ],\r\n",
      "        classes=('ship', ),\r\n",
      "        version='le90'))\r\n",
      "evaluation = dict(interval=1, metric='mAP')\r\n",
      "optimizer = dict(type='SGD', lr=0.005, momentum=0.9, weight_decay=0.0001)\r\n",
      "optimizer_config = dict(grad_clip=None)\r\n",
      "lr_config = dict(\r\n",
      "    policy='step',\r\n",
      "    warmup='linear',\r\n",
      "    warmup_iters=500,\r\n",
      "    warmup_ratio=0.001,\r\n",
      "    step=[8, 11])\r\n",
      "runner = dict(type='EpochBasedRunner', max_epochs=1)\r\n",
      "checkpoint_config = dict(interval=1)\r\n",
      "log_config = dict(interval=100, hooks=[dict(type='TextLoggerHook')])\r\n",
      "dist_params = dict(backend='nccl')\r\n",
      "log_level = 'INFO'\r\n",
      "load_from = None\r\n",
      "resume_from = None\r\n",
      "workflow = [('train', 1)]\r\n",
      "opencv_num_threads = 0\r\n",
      "mp_start_method = 'fork'\r\n",
      "angle_version = 'le90'\r\n",
      "classes = ('ship', )\r\n",
      "model = dict(\r\n",
      "    type='RoITransformer',\r\n",
      "    backbone=dict(\r\n",
      "        type='ResNet',\r\n",
      "        depth=50,\r\n",
      "        num_stages=4,\r\n",
      "        out_indices=(0, 1, 2, 3),\r\n",
      "        frozen_stages=1,\r\n",
      "        norm_cfg=dict(type='BN', requires_grad=True),\r\n",
      "        norm_eval=True,\r\n",
      "        style='pytorch',\r\n",
      "        init_cfg=dict(type='Pretrained', checkpoint='torchvision://resnet50')),\r\n",
      "    neck=dict(\r\n",
      "        type='FPN',\r\n",
      "        in_channels=[256, 512, 1024, 2048],\r\n",
      "        out_channels=256,\r\n",
      "        num_outs=5),\r\n",
      "    rpn_head=dict(\r\n",
      "        type='RotatedRPNHead',\r\n",
      "        in_channels=256,\r\n",
      "        feat_channels=256,\r\n",
      "        version='le90',\r\n",
      "        anchor_generator=dict(\r\n",
      "            type='AnchorGenerator',\r\n",
      "            scales=[8],\r\n",
      "            ratios=[0.5, 1.0, 2.0],\r\n",
      "            strides=[4, 8, 16, 32, 64]),\r\n",
      "        bbox_coder=dict(\r\n",
      "            type='DeltaXYWHBBoxCoder',\r\n",
      "            target_means=[0.0, 0.0, 0.0, 0.0],\r\n",
      "            target_stds=[1.0, 1.0, 1.0, 1.0]),\r\n",
      "        loss_cls=dict(\r\n",
      "            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),\r\n",
      "        loss_bbox=dict(\r\n",
      "            type='SmoothL1Loss', beta=0.1111111111111111, loss_weight=1.0)),\r\n",
      "    roi_head=dict(\r\n",
      "        type='RoITransRoIHead',\r\n",
      "        version='le90',\r\n",
      "        num_stages=2,\r\n",
      "        stage_loss_weights=[1, 1],\r\n",
      "        bbox_roi_extractor=[\r\n",
      "            dict(\r\n",
      "                type='SingleRoIExtractor',\r\n",
      "                roi_layer=dict(\r\n",
      "                    type='RoIAlign', output_size=7, sampling_ratio=0),\r\n",
      "                out_channels=256,\r\n",
      "                featmap_strides=[4, 8, 16, 32]),\r\n",
      "            dict(\r\n",
      "                type='RotatedSingleRoIExtractor',\r\n",
      "                roi_layer=dict(\r\n",
      "                    type='RoIAlignRotated',\r\n",
      "                    out_size=7,\r\n",
      "                    sample_num=2,\r\n",
      "                    clockwise=True),\r\n",
      "                out_channels=256,\r\n",
      "                featmap_strides=[4, 8, 16, 32])\r\n",
      "        ],\r\n",
      "        bbox_head=[\r\n",
      "            dict(\r\n",
      "                type='RotatedShared2FCBBoxHead',\r\n",
      "                in_channels=256,\r\n",
      "                fc_out_channels=1024,\r\n",
      "                roi_feat_size=7,\r\n",
      "                num_classes=1,\r\n",
      "                bbox_coder=dict(\r\n",
      "                    type='DeltaXYWHAHBBoxCoder',\r\n",
      "                    angle_range='le90',\r\n",
      "                    norm_factor=2,\r\n",
      "                    edge_swap=True,\r\n",
      "                    target_means=[0.0, 0.0, 0.0, 0.0, 0.0],\r\n",
      "                    target_stds=[0.1, 0.1, 0.2, 0.2, 1]),\r\n",
      "                reg_class_agnostic=True,\r\n",
      "                loss_cls=dict(\r\n",
      "                    type='CrossEntropyLoss',\r\n",
      "                    use_sigmoid=False,\r\n",
      "                    loss_weight=1.0),\r\n",
      "                loss_bbox=dict(type='SmoothL1Loss', beta=1.0,\r\n",
      "                               loss_weight=1.0)),\r\n",
      "            dict(\r\n",
      "                type='RotatedShared2FCBBoxHead',\r\n",
      "                in_channels=256,\r\n",
      "                fc_out_channels=1024,\r\n",
      "                roi_feat_size=7,\r\n",
      "                num_classes=1,\r\n",
      "                bbox_coder=dict(\r\n",
      "                    type='DeltaXYWHAOBBoxCoder',\r\n",
      "                    angle_range='le90',\r\n",
      "                    norm_factor=None,\r\n",
      "                    edge_swap=True,\r\n",
      "                    proj_xy=True,\r\n",
      "                    target_means=[0.0, 0.0, 0.0, 0.0, 0.0],\r\n",
      "                    target_stds=[0.05, 0.05, 0.1, 0.1, 0.5]),\r\n",
      "                reg_class_agnostic=False,\r\n",
      "                loss_cls=dict(\r\n",
      "                    type='CrossEntropyLoss',\r\n",
      "                    use_sigmoid=False,\r\n",
      "                    loss_weight=1.0),\r\n",
      "                loss_bbox=dict(type='SmoothL1Loss', beta=1.0, loss_weight=1.0))\r\n",
      "        ]),\r\n",
      "    train_cfg=dict(\r\n",
      "        rpn=dict(\r\n",
      "            assigner=dict(\r\n",
      "                type='MaxIoUAssigner',\r\n",
      "                pos_iou_thr=0.7,\r\n",
      "                neg_iou_thr=0.3,\r\n",
      "                min_pos_iou=0.3,\r\n",
      "                match_low_quality=True,\r\n",
      "                ignore_iof_thr=-1),\r\n",
      "            sampler=dict(\r\n",
      "                type='RandomSampler',\r\n",
      "                num=256,\r\n",
      "                pos_fraction=0.5,\r\n",
      "                neg_pos_ub=-1,\r\n",
      "                add_gt_as_proposals=False),\r\n",
      "            allowed_border=0,\r\n",
      "            pos_weight=-1,\r\n",
      "            debug=False),\r\n",
      "        rpn_proposal=dict(\r\n",
      "            nms_pre=2000,\r\n",
      "            max_per_img=2000,\r\n",
      "            nms=dict(type='nms', iou_threshold=0.7),\r\n",
      "            min_bbox_size=0),\r\n",
      "        rcnn=[\r\n",
      "            dict(\r\n",
      "                assigner=dict(\r\n",
      "                    type='MaxIoUAssigner',\r\n",
      "                    pos_iou_thr=0.5,\r\n",
      "                    neg_iou_thr=0.5,\r\n",
      "                    min_pos_iou=0.5,\r\n",
      "                    match_low_quality=False,\r\n",
      "                    ignore_iof_thr=-1,\r\n",
      "                    iou_calculator=dict(type='BboxOverlaps2D')),\r\n",
      "                sampler=dict(\r\n",
      "                    type='RandomSampler',\r\n",
      "                    num=512,\r\n",
      "                    pos_fraction=0.25,\r\n",
      "                    neg_pos_ub=-1,\r\n",
      "                    add_gt_as_proposals=True),\r\n",
      "                pos_weight=-1,\r\n",
      "                debug=False),\r\n",
      "            dict(\r\n",
      "                assigner=dict(\r\n",
      "                    type='MaxIoUAssigner',\r\n",
      "                    pos_iou_thr=0.5,\r\n",
      "                    neg_iou_thr=0.5,\r\n",
      "                    min_pos_iou=0.5,\r\n",
      "                    match_low_quality=False,\r\n",
      "                    ignore_iof_thr=-1,\r\n",
      "                    iou_calculator=dict(type='RBboxOverlaps2D')),\r\n",
      "                sampler=dict(\r\n",
      "                    type='RRandomSampler',\r\n",
      "                    num=512,\r\n",
      "                    pos_fraction=0.25,\r\n",
      "                    neg_pos_ub=-1,\r\n",
      "                    add_gt_as_proposals=True),\r\n",
      "                pos_weight=-1,\r\n",
      "                debug=False)\r\n",
      "        ]),\r\n",
      "    test_cfg=dict(\r\n",
      "        rpn=dict(\r\n",
      "            nms_pre=2000,\r\n",
      "            max_per_img=2000,\r\n",
      "            nms=dict(type='nms', iou_threshold=0.7),\r\n",
      "            min_bbox_size=0),\r\n",
      "        rcnn=dict(\r\n",
      "            nms_pre=2000,\r\n",
      "            min_bbox_size=0,\r\n",
      "            score_thr=0.05,\r\n",
      "            nms=dict(type='le90', iou_thr=0.1),\r\n",
      "            max_per_img=2000)))\r\n",
      "work_dir = '/kaggle/working/runs/roi_trans_train'\r\n",
      "auto_resume = False\r\n",
      "gpu_ids = range(0, 1)\r\n",
      "\r\n",
      "2025-03-18 09:31:43,422 - mmrotate - INFO - Set random seed to 2025877366, deterministic: False\r\n",
      "/usr/local/lib/python3.10/dist-packages/mmdet/models/dense_heads/anchor_head.py:116: UserWarning: DeprecationWarning: `num_anchors` is deprecated, for consistency or also use `num_base_priors` instead\r\n",
      "  warnings.warn('DeprecationWarning: `num_anchors` is deprecated, '\r\n",
      "2025-03-18 09:31:43,983 - mmcv - INFO - initialize ResNet with init_cfg {'type': 'Pretrained', 'checkpoint': 'torchvision://resnet50'}\r\n",
      "2025-03-18 09:31:43,984 - mmcv - INFO - load model from: torchvision://resnet50\r\n",
      "2025-03-18 09:31:43,984 - mmcv - INFO - load checkpoint from torchvision path: torchvision://resnet50\r\n",
      "Downloading: \"https://download.pytorch.org/models/resnet50-0676ba61.pth\" to /root/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth\r\n",
      "100%|███████████████████████████████████████| 97.8M/97.8M [00:00<00:00, 376MB/s]\r\n",
      "2025-03-18 09:31:44,407 - mmcv - WARNING - The model and loaded state dict do not match exactly\r\n",
      "\r\n",
      "unexpected key in source state_dict: fc.weight, fc.bias\r\n",
      "\r\n",
      "2025-03-18 09:31:44,429 - mmcv - INFO - initialize FPN with init_cfg {'type': 'Xavier', 'layer': 'Conv2d', 'distribution': 'uniform'}\r\n",
      "2025-03-18 09:31:44,453 - mmcv - INFO - initialize RotatedRPNHead with init_cfg {'type': 'Normal', 'layer': 'Conv2d', 'std': 0.01}\r\n",
      "2025-03-18 09:31:44,458 - mmcv - INFO - initialize RotatedShared2FCBBoxHead with init_cfg [{'type': 'Normal', 'std': 0.01, 'override': {'name': 'fc_cls'}}, {'type': 'Normal', 'std': 0.001, 'override': {'name': 'fc_reg'}}, {'type': 'Xavier', 'layer': 'Linear', 'override': [{'name': 'shared_fcs'}, {'name': 'cls_fcs'}, {'name': 'reg_fcs'}]}]\r\n",
      "2025-03-18 09:31:44,642 - mmcv - INFO - initialize RotatedShared2FCBBoxHead with init_cfg [{'type': 'Normal', 'std': 0.01, 'override': {'name': 'fc_cls'}}, {'type': 'Normal', 'std': 0.001, 'override': {'name': 'fc_reg'}}, {'type': 'Xavier', 'layer': 'Linear', 'override': [{'name': 'shared_fcs'}, {'name': 'cls_fcs'}, {'name': 'reg_fcs'}]}]\r\n",
      "2025-03-18 09:31:44,836 - mmcv - INFO - \r\n",
      "backbone.conv1.weight - torch.Size([64, 3, 7, 7]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,837 - mmcv - INFO - \r\n",
      "backbone.bn1.weight - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,837 - mmcv - INFO - \r\n",
      "backbone.bn1.bias - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,837 - mmcv - INFO - \r\n",
      "backbone.layer1.0.conv1.weight - torch.Size([64, 64, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,837 - mmcv - INFO - \r\n",
      "backbone.layer1.0.bn1.weight - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,837 - mmcv - INFO - \r\n",
      "backbone.layer1.0.bn1.bias - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,837 - mmcv - INFO - \r\n",
      "backbone.layer1.0.conv2.weight - torch.Size([64, 64, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,837 - mmcv - INFO - \r\n",
      "backbone.layer1.0.bn2.weight - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,837 - mmcv - INFO - \r\n",
      "backbone.layer1.0.bn2.bias - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,837 - mmcv - INFO - \r\n",
      "backbone.layer1.0.conv3.weight - torch.Size([256, 64, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,837 - mmcv - INFO - \r\n",
      "backbone.layer1.0.bn3.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.0.bn3.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.0.downsample.0.weight - torch.Size([256, 64, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.0.downsample.1.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.0.downsample.1.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.1.conv1.weight - torch.Size([64, 256, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.1.bn1.weight - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.1.bn1.bias - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.1.conv2.weight - torch.Size([64, 64, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.1.bn2.weight - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.1.bn2.bias - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,838 - mmcv - INFO - \r\n",
      "backbone.layer1.1.conv3.weight - torch.Size([256, 64, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,839 - mmcv - INFO - \r\n",
      "backbone.layer1.1.bn3.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,839 - mmcv - INFO - \r\n",
      "backbone.layer1.1.bn3.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,839 - mmcv - INFO - \r\n",
      "backbone.layer1.2.conv1.weight - torch.Size([64, 256, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,839 - mmcv - INFO - \r\n",
      "backbone.layer1.2.bn1.weight - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,839 - mmcv - INFO - \r\n",
      "backbone.layer1.2.bn1.bias - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,839 - mmcv - INFO - \r\n",
      "backbone.layer1.2.conv2.weight - torch.Size([64, 64, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,839 - mmcv - INFO - \r\n",
      "backbone.layer1.2.bn2.weight - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,839 - mmcv - INFO - \r\n",
      "backbone.layer1.2.bn2.bias - torch.Size([64]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,839 - mmcv - INFO - \r\n",
      "backbone.layer1.2.conv3.weight - torch.Size([256, 64, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,839 - mmcv - INFO - \r\n",
      "backbone.layer1.2.bn3.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer1.2.bn3.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer2.0.conv1.weight - torch.Size([128, 256, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer2.0.bn1.weight - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer2.0.bn1.bias - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer2.0.conv2.weight - torch.Size([128, 128, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer2.0.bn2.weight - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer2.0.bn2.bias - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer2.0.conv3.weight - torch.Size([512, 128, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer2.0.bn3.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer2.0.bn3.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,840 - mmcv - INFO - \r\n",
      "backbone.layer2.0.downsample.0.weight - torch.Size([512, 256, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.0.downsample.1.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.0.downsample.1.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.1.conv1.weight - torch.Size([128, 512, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.1.bn1.weight - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.1.bn1.bias - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.1.conv2.weight - torch.Size([128, 128, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.1.bn2.weight - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.1.bn2.bias - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.1.conv3.weight - torch.Size([512, 128, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.1.bn3.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.1.bn3.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,841 - mmcv - INFO - \r\n",
      "backbone.layer2.2.conv1.weight - torch.Size([128, 512, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.2.bn1.weight - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.2.bn1.bias - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.2.conv2.weight - torch.Size([128, 128, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.2.bn2.weight - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.2.bn2.bias - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.2.conv3.weight - torch.Size([512, 128, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.2.bn3.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.2.bn3.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.3.conv1.weight - torch.Size([128, 512, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.3.bn1.weight - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.3.bn1.bias - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,842 - mmcv - INFO - \r\n",
      "backbone.layer2.3.conv2.weight - torch.Size([128, 128, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer2.3.bn2.weight - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer2.3.bn2.bias - torch.Size([128]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer2.3.conv3.weight - torch.Size([512, 128, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer2.3.bn3.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer2.3.bn3.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer3.0.conv1.weight - torch.Size([256, 512, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer3.0.bn1.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer3.0.bn1.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer3.0.conv2.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer3.0.bn2.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,843 - mmcv - INFO - \r\n",
      "backbone.layer3.0.bn2.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.0.conv3.weight - torch.Size([1024, 256, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.0.bn3.weight - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.0.bn3.bias - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.0.downsample.0.weight - torch.Size([1024, 512, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.0.downsample.1.weight - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.0.downsample.1.bias - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.1.conv1.weight - torch.Size([256, 1024, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.1.bn1.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.1.bn1.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.1.conv2.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,844 - mmcv - INFO - \r\n",
      "backbone.layer3.1.bn2.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.1.bn2.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.1.conv3.weight - torch.Size([1024, 256, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.1.bn3.weight - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.1.bn3.bias - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.2.conv1.weight - torch.Size([256, 1024, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.2.bn1.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.2.bn1.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.2.conv2.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.2.bn2.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.2.bn2.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.2.conv3.weight - torch.Size([1024, 256, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,845 - mmcv - INFO - \r\n",
      "backbone.layer3.2.bn3.weight - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.2.bn3.bias - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.3.conv1.weight - torch.Size([256, 1024, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.3.bn1.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.3.bn1.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.3.conv2.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.3.bn2.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.3.bn2.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.3.conv3.weight - torch.Size([1024, 256, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.3.bn3.weight - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.3.bn3.bias - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,846 - mmcv - INFO - \r\n",
      "backbone.layer3.4.conv1.weight - torch.Size([256, 1024, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,847 - mmcv - INFO - \r\n",
      "backbone.layer3.4.bn1.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,847 - mmcv - INFO - \r\n",
      "backbone.layer3.4.bn1.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,847 - mmcv - INFO - \r\n",
      "backbone.layer3.4.conv2.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,847 - mmcv - INFO - \r\n",
      "backbone.layer3.4.bn2.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,847 - mmcv - INFO - \r\n",
      "backbone.layer3.4.bn2.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,847 - mmcv - INFO - \r\n",
      "backbone.layer3.4.conv3.weight - torch.Size([1024, 256, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,847 - mmcv - INFO - \r\n",
      "backbone.layer3.4.bn3.weight - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,847 - mmcv - INFO - \r\n",
      "backbone.layer3.4.bn3.bias - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,847 - mmcv - INFO - \r\n",
      "backbone.layer3.5.conv1.weight - torch.Size([256, 1024, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,847 - mmcv - INFO - \r\n",
      "backbone.layer3.5.bn1.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,848 - mmcv - INFO - \r\n",
      "backbone.layer3.5.bn1.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,848 - mmcv - INFO - \r\n",
      "backbone.layer3.5.conv2.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,848 - mmcv - INFO - \r\n",
      "backbone.layer3.5.bn2.weight - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,848 - mmcv - INFO - \r\n",
      "backbone.layer3.5.bn2.bias - torch.Size([256]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,848 - mmcv - INFO - \r\n",
      "backbone.layer3.5.conv3.weight - torch.Size([1024, 256, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,848 - mmcv - INFO - \r\n",
      "backbone.layer3.5.bn3.weight - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,848 - mmcv - INFO - \r\n",
      "backbone.layer3.5.bn3.bias - torch.Size([1024]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,848 - mmcv - INFO - \r\n",
      "backbone.layer4.0.conv1.weight - torch.Size([512, 1024, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,848 - mmcv - INFO - \r\n",
      "backbone.layer4.0.bn1.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,848 - mmcv - INFO - \r\n",
      "backbone.layer4.0.bn1.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.0.conv2.weight - torch.Size([512, 512, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.0.bn2.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.0.bn2.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.0.conv3.weight - torch.Size([2048, 512, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.0.bn3.weight - torch.Size([2048]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.0.bn3.bias - torch.Size([2048]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.0.downsample.0.weight - torch.Size([2048, 1024, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.0.downsample.1.weight - torch.Size([2048]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.0.downsample.1.bias - torch.Size([2048]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.1.conv1.weight - torch.Size([512, 2048, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.1.bn1.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,849 - mmcv - INFO - \r\n",
      "backbone.layer4.1.bn1.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.1.conv2.weight - torch.Size([512, 512, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.1.bn2.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.1.bn2.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.1.conv3.weight - torch.Size([2048, 512, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.1.bn3.weight - torch.Size([2048]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.1.bn3.bias - torch.Size([2048]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.2.conv1.weight - torch.Size([512, 2048, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.2.bn1.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.2.bn1.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.2.conv2.weight - torch.Size([512, 512, 3, 3]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.2.bn2.weight - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,850 - mmcv - INFO - \r\n",
      "backbone.layer4.2.bn2.bias - torch.Size([512]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "backbone.layer4.2.conv3.weight - torch.Size([2048, 512, 1, 1]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "backbone.layer4.2.bn3.weight - torch.Size([2048]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "backbone.layer4.2.bn3.bias - torch.Size([2048]): \r\n",
      "PretrainedInit: load from torchvision://resnet50 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "neck.lateral_convs.0.conv.weight - torch.Size([256, 256, 1, 1]): \r\n",
      "XavierInit: gain=1, distribution=uniform, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "neck.lateral_convs.0.conv.bias - torch.Size([256]): \r\n",
      "The value is the same before and after calling `init_weights` of RoITransformer  \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "neck.lateral_convs.1.conv.weight - torch.Size([256, 512, 1, 1]): \r\n",
      "XavierInit: gain=1, distribution=uniform, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "neck.lateral_convs.1.conv.bias - torch.Size([256]): \r\n",
      "The value is the same before and after calling `init_weights` of RoITransformer  \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "neck.lateral_convs.2.conv.weight - torch.Size([256, 1024, 1, 1]): \r\n",
      "XavierInit: gain=1, distribution=uniform, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "neck.lateral_convs.2.conv.bias - torch.Size([256]): \r\n",
      "The value is the same before and after calling `init_weights` of RoITransformer  \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "neck.lateral_convs.3.conv.weight - torch.Size([256, 2048, 1, 1]): \r\n",
      "XavierInit: gain=1, distribution=uniform, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "neck.lateral_convs.3.conv.bias - torch.Size([256]): \r\n",
      "The value is the same before and after calling `init_weights` of RoITransformer  \r\n",
      " \r\n",
      "2025-03-18 09:31:44,851 - mmcv - INFO - \r\n",
      "neck.fpn_convs.0.conv.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "XavierInit: gain=1, distribution=uniform, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "neck.fpn_convs.0.conv.bias - torch.Size([256]): \r\n",
      "The value is the same before and after calling `init_weights` of RoITransformer  \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "neck.fpn_convs.1.conv.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "XavierInit: gain=1, distribution=uniform, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "neck.fpn_convs.1.conv.bias - torch.Size([256]): \r\n",
      "The value is the same before and after calling `init_weights` of RoITransformer  \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "neck.fpn_convs.2.conv.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "XavierInit: gain=1, distribution=uniform, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "neck.fpn_convs.2.conv.bias - torch.Size([256]): \r\n",
      "The value is the same before and after calling `init_weights` of RoITransformer  \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "neck.fpn_convs.3.conv.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "XavierInit: gain=1, distribution=uniform, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "neck.fpn_convs.3.conv.bias - torch.Size([256]): \r\n",
      "The value is the same before and after calling `init_weights` of RoITransformer  \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "rpn_head.rpn_conv.weight - torch.Size([256, 256, 3, 3]): \r\n",
      "NormalInit: mean=0, std=0.01, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "rpn_head.rpn_conv.bias - torch.Size([256]): \r\n",
      "NormalInit: mean=0, std=0.01, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "rpn_head.rpn_cls.weight - torch.Size([3, 256, 1, 1]): \r\n",
      "NormalInit: mean=0, std=0.01, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "rpn_head.rpn_cls.bias - torch.Size([3]): \r\n",
      "NormalInit: mean=0, std=0.01, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,852 - mmcv - INFO - \r\n",
      "rpn_head.rpn_reg.weight - torch.Size([12, 256, 1, 1]): \r\n",
      "NormalInit: mean=0, std=0.01, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,853 - mmcv - INFO - \r\n",
      "rpn_head.rpn_reg.bias - torch.Size([12]): \r\n",
      "NormalInit: mean=0, std=0.01, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,853 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.0.fc_cls.weight - torch.Size([2, 1024]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,853 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.0.fc_cls.bias - torch.Size([2]): \r\n",
      "NormalInit: mean=0, std=0.01, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,853 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.0.fc_reg.weight - torch.Size([5, 1024]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,853 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.0.fc_reg.bias - torch.Size([5]): \r\n",
      "NormalInit: mean=0, std=0.001, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,853 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.0.shared_fcs.0.weight - torch.Size([1024, 12544]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,853 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.0.shared_fcs.0.bias - torch.Size([1024]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,853 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.0.shared_fcs.1.weight - torch.Size([1024, 1024]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,853 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.0.shared_fcs.1.bias - torch.Size([1024]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,853 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.1.fc_cls.weight - torch.Size([2, 1024]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,854 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.1.fc_cls.bias - torch.Size([2]): \r\n",
      "NormalInit: mean=0, std=0.01, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,854 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.1.fc_reg.weight - torch.Size([5, 1024]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,854 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.1.fc_reg.bias - torch.Size([5]): \r\n",
      "NormalInit: mean=0, std=0.001, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,854 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.1.shared_fcs.0.weight - torch.Size([1024, 12544]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,854 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.1.shared_fcs.0.bias - torch.Size([1024]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,854 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.1.shared_fcs.1.weight - torch.Size([1024, 1024]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:44,854 - mmcv - INFO - \r\n",
      "roi_head.bbox_head.1.shared_fcs.1.bias - torch.Size([1024]): \r\n",
      "XavierInit: gain=1, distribution=normal, bias=0 \r\n",
      " \r\n",
      "2025-03-18 09:31:47,231 - mmrotate - INFO - Start running, host: root@7bee4592b584, work_dir: /kaggle/working/runs/roi_trans_train\r\n",
      "2025-03-18 09:31:47,232 - mmrotate - INFO - Hooks will be executed in the following order:\r\n",
      "before_run:\r\n",
      "(VERY_HIGH   ) StepLrUpdaterHook                  \r\n",
      "(NORMAL      ) CheckpointHook                     \r\n",
      "(LOW         ) EvalHook                           \r\n",
      "(VERY_LOW    ) TextLoggerHook                     \r\n",
      " -------------------- \r\n",
      "before_train_epoch:\r\n",
      "(VERY_HIGH   ) StepLrUpdaterHook                  \r\n",
      "(LOW         ) IterTimerHook                      \r\n",
      "(LOW         ) EvalHook                           \r\n",
      "(VERY_LOW    ) TextLoggerHook                     \r\n",
      " -------------------- \r\n",
      "before_train_iter:\r\n",
      "(VERY_HIGH   ) StepLrUpdaterHook                  \r\n",
      "(LOW         ) IterTimerHook                      \r\n",
      "(LOW         ) EvalHook                           \r\n",
      " -------------------- \r\n",
      "after_train_iter:\r\n",
      "(ABOVE_NORMAL) OptimizerHook                      \r\n",
      "(NORMAL      ) CheckpointHook                     \r\n",
      "(LOW         ) IterTimerHook                      \r\n",
      "(LOW         ) EvalHook                           \r\n",
      "(VERY_LOW    ) TextLoggerHook                     \r\n",
      " -------------------- \r\n",
      "after_train_epoch:\r\n",
      "(NORMAL      ) CheckpointHook                     \r\n",
      "(LOW         ) EvalHook                           \r\n",
      "(VERY_LOW    ) TextLoggerHook                     \r\n",
      " -------------------- \r\n",
      "before_val_epoch:\r\n",
      "(LOW         ) IterTimerHook                      \r\n",
      "(VERY_LOW    ) TextLoggerHook                     \r\n",
      " -------------------- \r\n",
      "before_val_iter:\r\n",
      "(LOW         ) IterTimerHook                      \r\n",
      " -------------------- \r\n",
      "after_val_iter:\r\n",
      "(LOW         ) IterTimerHook                      \r\n",
      " -------------------- \r\n",
      "after_val_epoch:\r\n",
      "(VERY_LOW    ) TextLoggerHook                     \r\n",
      " -------------------- \r\n",
      "after_run:\r\n",
      "(VERY_LOW    ) TextLoggerHook                     \r\n",
      " -------------------- \r\n",
      "2025-03-18 09:31:47,232 - mmrotate - INFO - workflow: [('train', 1)], max: 1 epochs\r\n",
      "2025-03-18 09:31:47,232 - mmrotate - INFO - Checkpoints will be saved to /kaggle/working/runs/roi_trans_train by HardDiskBackend.\r\n",
      "/usr/local/lib/python3.10/dist-packages/mmdet/models/dense_heads/anchor_head.py:123: UserWarning: DeprecationWarning: anchor_generator is deprecated, please use \"prior_generator\" instead\r\n",
      "  warnings.warn('DeprecationWarning: anchor_generator is deprecated, '\r\n",
      "2025-03-18 09:32:28,382 - mmrotate - INFO - Epoch [1][100/1855]\tlr: 9.940e-04, eta: 0:12:00, time: 0.411, data_time: 0.032, memory: 3857, loss_rpn_cls: 0.4400, loss_rpn_bbox: 0.0342, s0.loss_cls: 0.1231, s0.acc: 97.5244, s0.loss_bbox: 0.1702, s1.loss_cls: 0.0862, s1.acc: 97.8691, s1.loss_bbox: 0.0113, loss: 0.8649\r\n",
      "2025-03-18 09:33:06,168 - mmrotate - INFO - Epoch [1][200/1855]\tlr: 1.993e-03, eta: 0:10:52, time: 0.378, data_time: 0.012, memory: 3857, loss_rpn_cls: 0.1337, loss_rpn_bbox: 0.0396, s0.loss_cls: 0.1656, s0.acc: 95.3936, s0.loss_bbox: 0.2509, s1.loss_cls: 0.0540, s1.acc: 99.0254, s1.loss_bbox: 0.0139, loss: 0.6578\r\n",
      "2025-03-18 09:33:43,553 - mmrotate - INFO - Epoch [1][300/1855]\tlr: 2.992e-03, eta: 0:10:02, time: 0.374, data_time: 0.012, memory: 3857, loss_rpn_cls: 0.0958, loss_rpn_bbox: 0.0313, s0.loss_cls: 0.1605, s0.acc: 95.3535, s0.loss_bbox: 0.2231, s1.loss_cls: 0.0477, s1.acc: 99.0518, s1.loss_bbox: 0.0195, loss: 0.5779\r\n",
      "2025-03-18 09:34:20,828 - mmrotate - INFO - Epoch [1][400/1855]\tlr: 3.991e-03, eta: 0:09:18, time: 0.373, data_time: 0.011, memory: 3857, loss_rpn_cls: 0.0788, loss_rpn_bbox: 0.0372, s0.loss_cls: 0.1612, s0.acc: 94.7812, s0.loss_bbox: 0.2056, s1.loss_cls: 0.0470, s1.acc: 98.8779, s1.loss_bbox: 0.0237, loss: 0.5535\r\n",
      "2025-03-18 09:34:58,088 - mmrotate - INFO - Epoch [1][500/1855]\tlr: 4.990e-03, eta: 0:08:36, time: 0.373, data_time: 0.011, memory: 3857, loss_rpn_cls: 0.0677, loss_rpn_bbox: 0.0334, s0.loss_cls: 0.1456, s0.acc: 95.2266, s0.loss_bbox: 0.1826, s1.loss_cls: 0.0419, s1.acc: 98.8516, s1.loss_bbox: 0.0300, loss: 0.5013\r\n",
      "2025-03-18 09:35:35,309 - mmrotate - INFO - Epoch [1][600/1855]\tlr: 5.000e-03, eta: 0:07:56, time: 0.372, data_time: 0.012, memory: 3857, loss_rpn_cls: 0.0674, loss_rpn_bbox: 0.0412, s0.loss_cls: 0.1609, s0.acc: 94.5020, s0.loss_bbox: 0.2421, s1.loss_cls: 0.0503, s1.acc: 98.6973, s1.loss_bbox: 0.0389, loss: 0.6009\r\n",
      "2025-03-18 09:36:12,483 - mmrotate - INFO - Epoch [1][700/1855]\tlr: 5.000e-03, eta: 0:07:17, time: 0.372, data_time: 0.012, memory: 3857, loss_rpn_cls: 0.0404, loss_rpn_bbox: 0.0258, s0.loss_cls: 0.1385, s0.acc: 95.1299, s0.loss_bbox: 0.1835, s1.loss_cls: 0.0391, s1.acc: 98.8594, s1.loss_bbox: 0.0435, loss: 0.4707\r\n",
      "2025-03-18 09:36:49,501 - mmrotate - INFO - Epoch [1][800/1855]\tlr: 5.000e-03, eta: 0:06:38, time: 0.370, data_time: 0.011, memory: 3857, loss_rpn_cls: 0.0400, loss_rpn_bbox: 0.0292, s0.loss_cls: 0.1330, s0.acc: 95.1484, s0.loss_bbox: 0.2110, s1.loss_cls: 0.0347, s1.acc: 98.9023, s1.loss_bbox: 0.0434, loss: 0.4913\r\n",
      "2025-03-18 09:37:26,689 - mmrotate - INFO - Epoch [1][900/1855]\tlr: 5.000e-03, eta: 0:06:00, time: 0.372, data_time: 0.012, memory: 3949, loss_rpn_cls: 0.0719, loss_rpn_bbox: 0.0385, s0.loss_cls: 0.1715, s0.acc: 94.1025, s0.loss_bbox: 0.2459, s1.loss_cls: 0.0515, s1.acc: 98.6357, s1.loss_bbox: 0.0451, loss: 0.6244\r\n",
      "2025-03-18 09:38:03,867 - mmrotate - INFO - Exp name: roi_trans_r50_fpn_1x_sccos.py\r\n",
      "2025-03-18 09:38:03,867 - mmrotate - INFO - Epoch [1][1000/1855]\tlr: 5.000e-03, eta: 0:05:21, time: 0.372, data_time: 0.011, memory: 3949, loss_rpn_cls: 0.0520, loss_rpn_bbox: 0.0288, s0.loss_cls: 0.1517, s0.acc: 94.6494, s0.loss_bbox: 0.2004, s1.loss_cls: 0.0412, s1.acc: 98.7578, s1.loss_bbox: 0.0457, loss: 0.5199\r\n",
      "2025-03-18 09:38:41,031 - mmrotate - INFO - Epoch [1][1100/1855]\tlr: 5.000e-03, eta: 0:04:43, time: 0.372, data_time: 0.011, memory: 3949, loss_rpn_cls: 0.0444, loss_rpn_bbox: 0.0233, s0.loss_cls: 0.1330, s0.acc: 95.2090, s0.loss_bbox: 0.1730, s1.loss_cls: 0.0401, s1.acc: 98.7510, s1.loss_bbox: 0.0502, loss: 0.4639\r\n",
      "2025-03-18 09:39:18,096 - mmrotate - INFO - Epoch [1][1200/1855]\tlr: 5.000e-03, eta: 0:04:06, time: 0.371, data_time: 0.011, memory: 3949, loss_rpn_cls: 0.0326, loss_rpn_bbox: 0.0234, s0.loss_cls: 0.1288, s0.acc: 95.0996, s0.loss_bbox: 0.1905, s1.loss_cls: 0.0427, s1.acc: 98.5742, s1.loss_bbox: 0.0621, loss: 0.4801\r\n",
      "2025-03-18 09:39:55,064 - mmrotate - INFO - Epoch [1][1300/1855]\tlr: 5.000e-03, eta: 0:03:28, time: 0.370, data_time: 0.011, memory: 3949, loss_rpn_cls: 0.0373, loss_rpn_bbox: 0.0261, s0.loss_cls: 0.1239, s0.acc: 95.3545, s0.loss_bbox: 0.1814, s1.loss_cls: 0.0416, s1.acc: 98.6387, s1.loss_bbox: 0.0619, loss: 0.4723\r\n",
      "2025-03-18 09:40:32,484 - mmrotate - INFO - Epoch [1][1400/1855]\tlr: 5.000e-03, eta: 0:02:50, time: 0.374, data_time: 0.012, memory: 3949, loss_rpn_cls: 0.0346, loss_rpn_bbox: 0.0309, s0.loss_cls: 0.1188, s0.acc: 95.5889, s0.loss_bbox: 0.1495, s1.loss_cls: 0.0375, s1.acc: 98.7354, s1.loss_bbox: 0.0572, loss: 0.4284\r\n",
      "2025-03-18 09:41:09,852 - mmrotate - INFO - Epoch [1][1500/1855]\tlr: 5.000e-03, eta: 0:02:13, time: 0.374, data_time: 0.012, memory: 3969, loss_rpn_cls: 0.0328, loss_rpn_bbox: 0.0273, s0.loss_cls: 0.1288, s0.acc: 94.9570, s0.loss_bbox: 0.1651, s1.loss_cls: 0.0471, s1.acc: 98.3633, s1.loss_bbox: 0.0743, loss: 0.4753\r\n",
      "2025-03-18 09:41:47,244 - mmrotate - INFO - Epoch [1][1600/1855]\tlr: 5.000e-03, eta: 0:01:35, time: 0.374, data_time: 0.012, memory: 3969, loss_rpn_cls: 0.0318, loss_rpn_bbox: 0.0301, s0.loss_cls: 0.1321, s0.acc: 94.9482, s0.loss_bbox: 0.1584, s1.loss_cls: 0.0468, s1.acc: 98.3457, s1.loss_bbox: 0.0722, loss: 0.4714\r\n",
      "2025-03-18 09:42:24,436 - mmrotate - INFO - Epoch [1][1700/1855]\tlr: 5.000e-03, eta: 0:00:58, time: 0.372, data_time: 0.012, memory: 3969, loss_rpn_cls: 0.0248, loss_rpn_bbox: 0.0204, s0.loss_cls: 0.1234, s0.acc: 95.3496, s0.loss_bbox: 0.1844, s1.loss_cls: 0.0385, s1.acc: 98.6533, s1.loss_bbox: 0.0612, loss: 0.4528\r\n",
      "2025-03-18 09:43:01,860 - mmrotate - INFO - Epoch [1][1800/1855]\tlr: 5.000e-03, eta: 0:00:20, time: 0.374, data_time: 0.012, memory: 3969, loss_rpn_cls: 0.0255, loss_rpn_bbox: 0.0229, s0.loss_cls: 0.1140, s0.acc: 95.6055, s0.loss_bbox: 0.1645, s1.loss_cls: 0.0372, s1.acc: 98.7070, s1.loss_bbox: 0.0547, loss: 0.4188\r\n",
      "2025-03-18 09:43:22,433 - mmrotate - INFO - Saving checkpoint at 1 epochs\r\n",
      "[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 464/464, 9.6 task/s, elapsed: 48s, ETA:     0s/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/albumentations/__init__.py:24: UserWarning: A new version of Albumentations is available: 2.0.5 (you have 1.4.20). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.\r\n",
      "  check_for_updates()\r\n",
      "/usr/local/lib/python3.10/dist-packages/albumentations/__init__.py:24: UserWarning: A new version of Albumentations is available: 2.0.5 (you have 1.4.20). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.\r\n",
      "  check_for_updates()\r\n",
      "/usr/local/lib/python3.10/dist-packages/albumentations/__init__.py:24: UserWarning: A new version of Albumentations is available: 2.0.5 (you have 1.4.20). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.\r\n",
      "  check_for_updates()\r\n",
      "/usr/local/lib/python3.10/dist-packages/albumentations/__init__.py:24: UserWarning: A new version of Albumentations is available: 2.0.5 (you have 1.4.20). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.\r\n",
      "  check_for_updates()\r\n",
      "2025-03-18 09:44:19,757 - mmrotate - INFO - \r\n",
      "+-------+------+------+--------+-------+\r\n",
      "| class | gts  | dets | recall | ap    |\r\n",
      "+-------+------+------+--------+-------+\r\n",
      "| ship  | 2147 | 3682 | 0.538  | 0.431 |\r\n",
      "+-------+------+------+--------+-------+\r\n",
      "| mAP   |      |      |        | 0.431 |\r\n",
      "+-------+------+------+--------+-------+\r\n",
      "2025-03-18 09:44:19,832 - mmrotate - INFO - Exp name: roi_trans_r50_fpn_1x_sccos.py\r\n",
      "2025-03-18 09:44:19,832 - mmrotate - INFO - Epoch(val) [1][464]\tmAP: 0.4307\r\n",
      "Training completed.\n"
     ]
    }
   ],
   "source": [
    "# Step 8: Train the Model\n",
    "%cd /kaggle/working/mmrotate\n",
    "!mkdir -p /kaggle/working/runs/roi_trans_train\n",
    "!python tools/train.py \\\n",
    "    configs/roi_trans/roi_trans_r50_fpn_1x_sccos.py \\\n",
    "    --work-dir /kaggle/working/runs/roi_trans_train \\\n",
    "    --gpus 1\n",
    "\n",
    "print(\"Training completed.\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "72e8d9a1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-18T09:44:22.382332Z",
     "iopub.status.busy": "2025-03-18T09:44:22.381967Z",
     "iopub.status.idle": "2025-03-18T09:45:27.157646Z",
     "shell.execute_reply": "2025-03-18T09:45:27.156435Z"
    },
    "papermill": {
     "duration": 64.850633,
     "end_time": "2025-03-18T09:45:27.159435",
     "exception": false,
     "start_time": "2025-03-18T09:44:22.308802",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/working/mmrotate\n",
      "/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/albumentations/__init__.py:24: UserWarning: A new version of Albumentations is available: 2.0.5 (you have 1.4.20). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.\r\n",
      "  check_for_updates()\r\n",
      "/kaggle/working/mmrotate/mmrotate/utils/setup_env.py:38: UserWarning: Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed.\r\n",
      "  warnings.warn(\r\n",
      "/kaggle/working/mmrotate/mmrotate/utils/setup_env.py:48: UserWarning: Setting MKL_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/mmdet/models/dense_heads/anchor_head.py:116: UserWarning: DeprecationWarning: `num_anchors` is deprecated, for consistency or also use `num_base_priors` instead\r\n",
      "  warnings.warn('DeprecationWarning: `num_anchors` is deprecated, '\r\n",
      "load checkpoint from local path: /kaggle/working/runs/roi_trans_train/latest.pth\r\n",
      "[                                                  ] 0/464, elapsed: 0s, ETA:/usr/local/lib/python3.10/dist-packages/mmdet/models/dense_heads/anchor_head.py:123: UserWarning: DeprecationWarning: anchor_generator is deprecated, please use \"prior_generator\" instead\r\n",
      "  warnings.warn('DeprecationWarning: anchor_generator is deprecated, '\r\n",
      "[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 464/464, 9.4 task/s, elapsed: 49s, ETA:     0s\r\n",
      "writing results to /kaggle/working/runs/roi_trans_test/results.pkl\r\n",
      "/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/albumentations/__init__.py:24: UserWarning: A new version of Albumentations is available: 2.0.5 (you have 1.4.20). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.\r\n",
      "  check_for_updates()\r\n",
      "/usr/local/lib/python3.10/dist-packages/albumentations/__init__.py:24: UserWarning: A new version of Albumentations is available: 2.0.5 (you have 1.4.20). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.\r\n",
      "  check_for_updates()\r\n",
      "/usr/local/lib/python3.10/dist-packages/albumentations/__init__.py:24: UserWarning: A new version of Albumentations is available: 2.0.5 (you have 1.4.20). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.\r\n",
      "  check_for_updates()\r\n",
      "/usr/local/lib/python3.10/dist-packages/albumentations/__init__.py:24: UserWarning: A new version of Albumentations is available: 2.0.5 (you have 1.4.20). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.\r\n",
      "  check_for_updates()\r\n",
      "\r\n",
      "+-------+------+------+--------+-------+\r\n",
      "| class | gts  | dets | recall | ap    |\r\n",
      "+-------+------+------+--------+-------+\r\n",
      "| ship  | 1737 | 3509 | 0.617  | 0.502 |\r\n",
      "+-------+------+------+--------+-------+\r\n",
      "| mAP   |      |      |        | 0.502 |\r\n",
      "+-------+------+------+--------+-------+\r\n",
      "{'mAP': 0.5017390251159668}\r\n",
      "Testing completed.\n"
     ]
    }
   ],
   "source": [
    "# Step 9: Test the Model\n",
    "%cd /kaggle/working/mmrotate\n",
    "!mkdir -p /kaggle/working/runs/roi_trans_test\n",
    "!python tools/test.py \\\n",
    "    configs/roi_trans/roi_trans_r50_fpn_1x_sccos.py \\\n",
    "    /kaggle/working/runs/roi_trans_train/latest.pth \\\n",
    "    --eval mAP \\\n",
    "    --out /kaggle/working/runs/roi_trans_test/results.pkl\n",
    "\n",
    "print(\"Testing completed.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "575f701d",
   "metadata": {
    "papermill": {
     "duration": 0.0875,
     "end_time": "2025-03-18T09:45:27.332317",
     "exception": false,
     "start_time": "2025-03-18T09:45:27.244817",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "gpu",
   "dataSources": [
    {
     "datasetId": 6771261,
     "sourceId": 10895847,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30919,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 1277.217072,
   "end_time": "2025-03-18T09:45:28.145819",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-03-18T09:24:10.928747",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
